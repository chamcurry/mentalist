<div class="container">
  <div class="row">
  <% posts.last(6).each do |post| %>
    <div class="col-lg-4 col-md-6 col-sm-6">
     <div class="card-deck">
    <%= link_to post_path(post) do %>
      <div class="card p-1">
        <div class="card-img">
            <% if post.image.attached? %>
              <%= image_tag post.image,:style =>"max-width: 100%";%>
            <% end %>
        </div>
        <div class="card-img-overlay">
          <span id="star-rate-<%= post.id %>">
              <script>
                $('#star-rate-<%= post.id %>').raty({
                  size: 36,
                  starOff: "<%= asset_path('star-off.png') %>",
                  starOn: "<%= asset_path('star-on.png') %>",
                  starHalf: "<%= asset_path('star-half.png') %>",
                  half: true,
                  readOnly: true,
                  score: <%= post.star %>
                });
              </script>
            </span>
        </div>
    <% end %>
        <div class="card-body bg-dark text-light mt-1 pt-2" style="height: 12rem;">
            <div class="row h6 my-0 d-flex align-items-center">
                <%= image_tag post.menber.get_profile_image,size: "30x30",class: "border rounded-circle mx-2"%>
              <%=post.menber.full_name.truncate(5) %>
              <div class="strftime col d-flex justify-content-end">
                <%=post.created_at.strftime('%y/%m/%d') %>
              </div>
            </div>
          <div class="card-title d-flex-justify-content-center my-1 ">
            <div class="col">
              <%=post.title%>
            </div>
          </div>
          <div class="card-text px-2">
            <div><%= post.body.truncate(20) %></div>

            <div class="row mt-3 d-flex ">
              <div class="col p-0 d-flex justify-content-end align-items-center">
                <% post.genres.each do |genre| %>
                  <span class= 'mx-1 badge badge-secondary'><%= genre.soup %></span>
                <% end %>
                <i class="far fa-comment-alt text-info mx-2"><%= post.comments.count%></i>
                <!--メンバーがサインインかつ、idが１では無いとき-->
                <% if menber_signed_in? && current_menber.id != 1 %>
                  <!--投稿に紐ついているいいねがログインしているメンバーのものなら-->
                  <% if post.favorited_by?(current_menber) %>
                    <%= link_to post_favorites_path(post), method: :delete do %>
                      <i class="fas fa-heart text-danger"><%= post.favorites.count%></i>
                    <% end %>
                  <% else %>
                    <%= link_to post_favorites_path(post), method: :post do %>
                      <i class="fas fa-heart text-muted"><%= post.favorites.count %></i>
                    <% end %>
                  <% end %>
                <% else %>
                  <i class="fas fa-heart text-muted"><%= post.favorites.count %></i>
                <% end %>
              </div>
            </div>
            </span>
          </div>
        </div>
      </div>
     </div>
    </div>
  <% end %>
  </div>

</div>